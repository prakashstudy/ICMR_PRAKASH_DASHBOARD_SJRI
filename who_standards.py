WHO_BMI_LMS = {
    'boys': {
        0: {'L': -0.3053, 'M': 13.4069, 'S': 0.0956},
        1: {'L': 0.2708, 'M': 14.9441, 'S': 0.09027},
        2: {'L': 0.1118, 'M': 16.3195, 'S': 0.08677},
        3: {'L': 0.0068, 'M': 16.8987, 'S': 0.08495},
        4: {'L': -0.0727, 'M': 17.1579, 'S': 0.08378},
        5: {'L': -0.137, 'M': 17.2919, 'S': 0.08296},
        6: {'L': -0.1913, 'M': 17.3422, 'S': 0.08234},
        7: {'L': -0.2385, 'M': 17.3288, 'S': 0.08183},
        8: {'L': -0.2802, 'M': 17.2647, 'S': 0.0814},
        9: {'L': -0.3176, 'M': 17.1662, 'S': 0.08102},
        10: {'L': -0.3516, 'M': 17.0488, 'S': 0.08068},
        11: {'L': -0.3828, 'M': 16.9239, 'S': 0.08037},
        12: {'L': -0.4115, 'M': 16.7981, 'S': 0.08009},
        13: {'L': -0.4382, 'M': 16.6743, 'S': 0.07982},
        14: {'L': -0.463, 'M': 16.5548, 'S': 0.07958},
        15: {'L': -0.4863, 'M': 16.4409, 'S': 0.07935},
        16: {'L': -0.5082, 'M': 16.3335, 'S': 0.07913},
        17: {'L': -0.5289, 'M': 16.2329, 'S': 0.07892},
        18: {'L': -0.5484, 'M': 16.1392, 'S': 0.07873},
        19: {'L': -0.5669, 'M': 16.0528, 'S': 0.07854},
        20: {'L': -0.5846, 'M': 15.9743, 'S': 0.07836},
        21: {'L': -0.6014, 'M': 15.9039, 'S': 0.07818},
        22: {'L': -0.6174, 'M': 15.8412, 'S': 0.07802},
        23: {'L': -0.6328, 'M': 15.7852, 'S': 0.07786},
        24: {'L': -0.6187, 'M': 16.0189, 'S': 0.0800},
        25: {'L': -0.584, 'M': 15.98, 'S': 0.07792},
        26: {'L': -0.5497, 'M': 15.9414, 'S': 0.078},
        27: {'L': -0.5166, 'M': 15.9036, 'S': 0.07808},
        28: {'L': -0.485, 'M': 15.8667, 'S': 0.07818},
        29: {'L': -0.4552, 'M': 15.8306, 'S': 0.07829},
        30: {'L': -0.4274, 'M': 15.7953, 'S': 0.07841},
        31: {'L': -0.4016, 'M': 15.7606, 'S': 0.07854},
        32: {'L': -0.3782, 'M': 15.7267, 'S': 0.07867},
        33: {'L': -0.3572, 'M': 15.6934, 'S': 0.07882},
        34: {'L': -0.3388, 'M': 15.661, 'S': 0.07897},
        35: {'L': -0.3231, 'M': 15.6294, 'S': 0.07914},
        36: {'L': -0.3101, 'M': 15.5988, 'S': 0.07931},
        37: {'L': -0.3, 'M': 15.5693, 'S': 0.0795},
        38: {'L': -0.2927, 'M': 15.541, 'S': 0.07969},
        39: {'L': -0.2884, 'M': 15.514, 'S': 0.0799},
        40: {'L': -0.2869, 'M': 15.4885, 'S': 0.08012},
        41: {'L': -0.2881, 'M': 15.4645, 'S': 0.08036},
        42: {'L': -0.2919, 'M': 15.442, 'S': 0.08061},
        43: {'L': -0.2981, 'M': 15.421, 'S': 0.08087},
        44: {'L': -0.3067, 'M': 15.4013, 'S': 0.08115},
        45: {'L': -0.3174, 'M': 15.3827, 'S': 0.08144},
        46: {'L': -0.3303, 'M': 15.3652, 'S': 0.08174},
        47: {'L': -0.3452, 'M': 15.3485, 'S': 0.08205},
        48: {'L': -0.3622, 'M': 15.3326, 'S': 0.08238},
        49: {'L': -0.3811, 'M': 15.3174, 'S': 0.08272},
        50: {'L': -0.4019, 'M': 15.3029, 'S': 0.08307},
        51: {'L': -0.4245, 'M': 15.2891, 'S': 0.08343},
        52: {'L': -0.4488, 'M': 15.2759, 'S': 0.0838},
        53: {'L': -0.4747, 'M': 15.2633, 'S': 0.08418},
        54: {'L': -0.5019, 'M': 15.2514, 'S': 0.08457},
        55: {'L': -0.5303, 'M': 15.24, 'S': 0.08496},
        56: {'L': -0.5599, 'M': 15.2291, 'S': 0.08536},
        57: {'L': -0.5905, 'M': 15.2188, 'S': 0.08577},
        58: {'L': -0.6223, 'M': 15.2091, 'S': 0.08617},
        59: {'L': -0.6552, 'M': 15.2, 'S': 0.08659},
        60: {'L': -0.6892, 'M': 15.1916, 'S': 0.087},
        61: {'L': -0.7387, 'M': 15.2641, 'S': 0.0839},
        62: {'L': -0.7621, 'M': 15.2616, 'S': 0.08414},
        63: {'L': -0.7856, 'M': 15.2604, 'S': 0.08439},
        64: {'L': -0.8089, 'M': 15.2605, 'S': 0.08464},
        65: {'L': -0.8322, 'M': 15.2619, 'S': 0.0849},
        66: {'L': -0.8554, 'M': 15.2645, 'S': 0.08516},
        67: {'L': -0.8785, 'M': 15.2684, 'S': 0.08543},
        68: {'L': -0.9015, 'M': 15.2737, 'S': 0.0857},
        69: {'L': -0.9243, 'M': 15.2801, 'S': 0.08597},
        70: {'L': -0.9471, 'M': 15.2877, 'S': 0.08625},
        71: {'L': -0.9697, 'M': 15.2965, 'S': 0.08653},
        72: {'L': -0.9921, 'M': 15.3062, 'S': 0.08682},
        73: {'L': -1.0144, 'M': 15.3169, 'S': 0.08711},
        74: {'L': -1.0365, 'M': 15.3285, 'S': 0.08741},
        75: {'L': -1.0584, 'M': 15.3408, 'S': 0.08771},
        76: {'L': -1.0801, 'M': 15.354, 'S': 0.08802},
        77: {'L': -1.1017, 'M': 15.3679, 'S': 0.08833},
        78: {'L': -1.123, 'M': 15.3825, 'S': 0.08865},
        79: {'L': -1.1441, 'M': 15.3978, 'S': 0.08898},
        80: {'L': -1.1649, 'M': 15.4137, 'S': 0.08931},
        81: {'L': -1.1856, 'M': 15.4302, 'S': 0.08964},
        82: {'L': -1.206, 'M': 15.4473, 'S': 0.08998},
        83: {'L': -1.2261, 'M': 15.465, 'S': 0.09033},
        84: {'L': -1.246, 'M': 15.4832, 'S': 0.09068},
        85: {'L': -1.2656, 'M': 15.5019, 'S': 0.09103},
        86: {'L': -1.2849, 'M': 15.521, 'S': 0.09139},
        87: {'L': -1.304, 'M': 15.5407, 'S': 0.09176},
        88: {'L': -1.3228, 'M': 15.5608, 'S': 0.09213},
        89: {'L': -1.3414, 'M': 15.5814, 'S': 0.09251},
        90: {'L': -1.3596, 'M': 15.6023, 'S': 0.09289},
        91: {'L': -1.3776, 'M': 15.6237, 'S': 0.09327},
        92: {'L': -1.3953, 'M': 15.6455, 'S': 0.09366},
        93: {'L': -1.4126, 'M': 15.6677, 'S': 0.09406},
        94: {'L': -1.4297, 'M': 15.6903, 'S': 0.09445},
        95: {'L': -1.4464, 'M': 15.7133, 'S': 0.09486},
        96: {'L': -1.4629, 'M': 15.7368, 'S': 0.09526},
        97: {'L': -1.479, 'M': 15.7606, 'S': 0.09567},
        98: {'L': -1.4947, 'M': 15.7848, 'S': 0.09609},
        99: {'L': -1.5101, 'M': 15.8094, 'S': 0.09651},
        100: {'L': -1.5252, 'M': 15.8344, 'S': 0.09693},
        101: {'L': -1.5399, 'M': 15.8597, 'S': 0.09735},
        102: {'L': -1.5542, 'M': 15.8855, 'S': 0.09778},
        103: {'L': -1.5681, 'M': 15.9116, 'S': 0.09821},
        104: {'L': -1.5817, 'M': 15.9381, 'S': 0.09864},
        105: {'L': -1.5948, 'M': 15.9651, 'S': 0.09907},
        106: {'L': -1.6076, 'M': 15.9925, 'S': 0.09951},
        107: {'L': -1.6199, 'M': 16.0205, 'S': 0.09994},
        108: {'L': -1.6318, 'M': 16.049, 'S': 0.10038},
        109: {'L': -1.6433, 'M': 16.0781, 'S': 0.10082},
        110: {'L': -1.6544, 'M': 16.1078, 'S': 0.10126},
        111: {'L': -1.6651, 'M': 16.1381, 'S': 0.1017},
        112: {'L': -1.6753, 'M': 16.1692, 'S': 0.10214},
        113: {'L': -1.6851, 'M': 16.2009, 'S': 0.10259},
        114: {'L': -1.6944, 'M': 16.2333, 'S': 0.10303},
        115: {'L': -1.7032, 'M': 16.2665, 'S': 0.10347},
        116: {'L': -1.7116, 'M': 16.3004, 'S': 0.10391},
        117: {'L': -1.7196, 'M': 16.3351, 'S': 0.10435},
        118: {'L': -1.7271, 'M': 16.3704, 'S': 0.10478},
        119: {'L': -1.7341, 'M': 16.4065, 'S': 0.10522},
        120: {'L': -1.7407, 'M': 16.4433, 'S': 0.10566},
        121: {'L': -1.7468, 'M': 16.4807, 'S': 0.10609},
        122: {'L': -1.7525, 'M': 16.5189, 'S': 0.10652},
        123: {'L': -1.7578, 'M': 16.5578, 'S': 0.10695},
        124: {'L': -1.7626, 'M': 16.5974, 'S': 0.10738},
        125: {'L': -1.767, 'M': 16.6376, 'S': 0.1078},
        126: {'L': -1.771, 'M': 16.6786, 'S': 0.10823},
        127: {'L': -1.7745, 'M': 16.7203, 'S': 0.10865},
        128: {'L': -1.7777, 'M': 16.7628, 'S': 0.10906},
        129: {'L': -1.7804, 'M': 16.8059, 'S': 0.10948},
        130: {'L': -1.7828, 'M': 16.8497, 'S': 0.10989},
        131: {'L': -1.7847, 'M': 16.8941, 'S': 0.1103},
        132: {'L': -1.7862, 'M': 16.9392, 'S': 0.1107},
        133: {'L': -1.7873, 'M': 16.985, 'S': 0.1111},
        134: {'L': -1.7881, 'M': 17.0314, 'S': 0.1115},
        135: {'L': -1.7884, 'M': 17.0784, 'S': 0.11189},
        136: {'L': -1.7884, 'M': 17.1262, 'S': 0.11228},
        137: {'L': -1.788, 'M': 17.1746, 'S': 0.11266},
        138: {'L': -1.7873, 'M': 17.2236, 'S': 0.11304},
        139: {'L': -1.7861, 'M': 17.2734, 'S': 0.11342},
        140: {'L': -1.7846, 'M': 17.324, 'S': 0.11379},
        141: {'L': -1.7828, 'M': 17.3752, 'S': 0.11415},
        142: {'L': -1.7806, 'M': 17.4272, 'S': 0.11451},
        143: {'L': -1.778, 'M': 17.4799, 'S': 0.11487},
        144: {'L': -1.7751, 'M': 17.5334, 'S': 0.11522},
        145: {'L': -1.7719, 'M': 17.5877, 'S': 0.11556},
        146: {'L': -1.7684, 'M': 17.6427, 'S': 0.1159},
        147: {'L': -1.7645, 'M': 17.6985, 'S': 0.11623},
        148: {'L': -1.7604, 'M': 17.7551, 'S': 0.11656},
        149: {'L': -1.7559, 'M': 17.8124, 'S': 0.11688},
        150: {'L': -1.7511, 'M': 17.8704, 'S': 0.1172},
        151: {'L': -1.7461, 'M': 17.9292, 'S': 0.11751},
        152: {'L': -1.7408, 'M': 17.9887, 'S': 0.11781},
        153: {'L': -1.7352, 'M': 18.0488, 'S': 0.11811},
        154: {'L': -1.7293, 'M': 18.1096, 'S': 0.11841},
        155: {'L': -1.7232, 'M': 18.171, 'S': 0.11869},
        156: {'L': -1.7168, 'M': 18.233, 'S': 0.11898},
        157: {'L': -1.7102, 'M': 18.2955, 'S': 0.11925},
        158: {'L': -1.7033, 'M': 18.3586, 'S': 0.11952},
        159: {'L': -1.6962, 'M': 18.4221, 'S': 0.11979},
        160: {'L': -1.6888, 'M': 18.486, 'S': 0.12005},
        161: {'L': -1.6811, 'M': 18.5502, 'S': 0.1203},
        162: {'L': -1.6732, 'M': 18.6148, 'S': 0.12055},
        163: {'L': -1.6651, 'M': 18.6795, 'S': 0.12079},
        164: {'L': -1.6568, 'M': 18.7445, 'S': 0.12102},
        165: {'L': -1.6482, 'M': 18.8095, 'S': 0.12125},
        166: {'L': -1.6394, 'M': 18.8746, 'S': 0.12148},
        167: {'L': -1.6304, 'M': 18.9398, 'S': 0.1217},
        168: {'L': -1.6211, 'M': 19.005, 'S': 0.12191},
        169: {'L': -1.6116, 'M': 19.0701, 'S': 0.12212},
        170: {'L': -1.602, 'M': 19.1351, 'S': 0.12233},
        171: {'L': -1.5921, 'M': 19.2, 'S': 0.12253},
        172: {'L': -1.5821, 'M': 19.2648, 'S': 0.12272},
        173: {'L': -1.5719, 'M': 19.3294, 'S': 0.12291},
        174: {'L': -1.5615, 'M': 19.3937, 'S': 0.1231},
        175: {'L': -1.551, 'M': 19.4578, 'S': 0.12328},
        176: {'L': -1.5403, 'M': 19.5217, 'S': 0.12346},
        177: {'L': -1.5294, 'M': 19.5853, 'S': 0.12363},
        178: {'L': -1.5185, 'M': 19.6486, 'S': 0.1238},
        179: {'L': -1.5074, 'M': 19.7117, 'S': 0.12396},
        180: {'L': -1.4961, 'M': 19.7744, 'S': 0.12412},
        181: {'L': -1.4848, 'M': 19.8367, 'S': 0.12428},
        182: {'L': -1.4733, 'M': 19.8987, 'S': 0.12443},
        183: {'L': -1.4617, 'M': 19.9603, 'S': 0.12458},
        184: {'L': -1.45, 'M': 20.0215, 'S': 0.12473},
        185: {'L': -1.4382, 'M': 20.0823, 'S': 0.12487},
        186: {'L': -1.4263, 'M': 20.1427, 'S': 0.12501},
        187: {'L': -1.4143, 'M': 20.2026, 'S': 0.12514},
        188: {'L': -1.4022, 'M': 20.2621, 'S': 0.12528},
        189: {'L': -1.39, 'M': 20.3211, 'S': 0.12541},
        190: {'L': -1.3777, 'M': 20.3796, 'S': 0.12554},
        191: {'L': -1.3653, 'M': 20.4376, 'S': 0.12567},
        192: {'L': -1.3529, 'M': 20.4951, 'S': 0.12579},
        193: {'L': -1.3403, 'M': 20.5521, 'S': 0.12591},
        194: {'L': -1.3277, 'M': 20.6085, 'S': 0.12603},
        195: {'L': -1.3149, 'M': 20.6644, 'S': 0.12615},
        196: {'L': -1.3021, 'M': 20.7197, 'S': 0.12627},
        197: {'L': -1.2892, 'M': 20.7745, 'S': 0.12638},
        198: {'L': -1.2762, 'M': 20.8287, 'S': 0.1265},
        199: {'L': -1.2631, 'M': 20.8824, 'S': 0.12661},
        200: {'L': -1.2499, 'M': 20.9355, 'S': 0.12672},
        201: {'L': -1.2366, 'M': 20.9881, 'S': 0.12683},
        202: {'L': -1.2233, 'M': 21.04, 'S': 0.12694},
        203: {'L': -1.2098, 'M': 21.0914, 'S': 0.12704},
        204: {'L': -1.1962, 'M': 21.1423, 'S': 0.12715},
        205: {'L': -1.1826, 'M': 21.1925, 'S': 0.12726},
        206: {'L': -1.1688, 'M': 21.2423, 'S': 0.12736},
        207: {'L': -1.155, 'M': 21.2914, 'S': 0.12746},
        208: {'L': -1.141, 'M': 21.34, 'S': 0.12756},
        209: {'L': -1.127, 'M': 21.388, 'S': 0.12767},
        210: {'L': -1.1129, 'M': 21.4354, 'S': 0.12777},
        211: {'L': -1.0986, 'M': 21.4822, 'S': 0.12787},
        212: {'L': -1.0843, 'M': 21.5285, 'S': 0.12797},
        213: {'L': -1.0699, 'M': 21.5742, 'S': 0.12807},
        214: {'L': -1.0553, 'M': 21.6193, 'S': 0.12816},
        215: {'L': -1.0407, 'M': 21.6638, 'S': 0.12826},
        216: {'L': -1.026, 'M': 21.7077, 'S': 0.12836},
        217: {'L': -1.0112, 'M': 21.751, 'S': 0.12845},
        218: {'L': -0.9962, 'M': 21.7937, 'S': 0.12855},
        219: {'L': -0.9812, 'M': 21.8358, 'S': 0.12864},
        220: {'L': -0.9661, 'M': 21.8773, 'S': 0.12874},
        221: {'L': -0.9509, 'M': 21.9182, 'S': 0.12883},
        222: {'L': -0.9356, 'M': 21.9585, 'S': 0.12893},
        223: {'L': -0.9202, 'M': 21.9982, 'S': 0.12902},
        224: {'L': -0.9048, 'M': 22.0374, 'S': 0.12911},
        225: {'L': -0.8892, 'M': 22.076, 'S': 0.1292},
        226: {'L': -0.8735, 'M': 22.114, 'S': 0.1293},
        227: {'L': -0.8578, 'M': 22.1514, 'S': 0.12939},
        228: {'L': -0.8419, 'M': 22.1883, 'S': 0.12948},
    },
    'girls': {
        0: {'L': -0.0631, 'M': 13.3363, 'S': 0.09272},
        1: {'L': 0.3448, 'M': 14.5679, 'S': 0.09556},
        2: {'L': 0.1749, 'M': 15.7679, 'S': 0.09371},
        3: {'L': 0.0643, 'M': 16.3574, 'S': 0.09254},
        4: {'L': -0.0191, 'M': 16.6703, 'S': 0.09166},
        5: {'L': -0.0864, 'M': 16.8386, 'S': 0.09096},
        6: {'L': -0.1429, 'M': 16.9083, 'S': 0.09036},
        7: {'L': -0.1916, 'M': 16.902, 'S': 0.08984},
        8: {'L': -0.2344, 'M': 16.8404, 'S': 0.08939},
        9: {'L': -0.2725, 'M': 16.7406, 'S': 0.08898},
        10: {'L': -0.3068, 'M': 16.6184, 'S': 0.08861},
        11: {'L': -0.3381, 'M': 16.4875, 'S': 0.08828},
        12: {'L': -0.3667, 'M': 16.3568, 'S': 0.08797},
        13: {'L': -0.3932, 'M': 16.2311, 'S': 0.08768},
        14: {'L': -0.4177, 'M': 16.1128, 'S': 0.08741},
        15: {'L': -0.4407, 'M': 16.0028, 'S': 0.08716},
        16: {'L': -0.4623, 'M': 15.9017, 'S': 0.08693},
        17: {'L': -0.4825, 'M': 15.8096, 'S': 0.08671},
        18: {'L': -0.5017, 'M': 15.7263, 'S': 0.0865},
        19: {'L': -0.5199, 'M': 15.6517, 'S': 0.0863},
        20: {'L': -0.5372, 'M': 15.5855, 'S': 0.08612},
        21: {'L': -0.5537, 'M': 15.5278, 'S': 0.08594},
        22: {'L': -0.5695, 'M': 15.4787, 'S': 0.08577},
        23: {'L': -0.5846, 'M': 15.438, 'S': 0.0856},
        24: {'L': -0.5684, 'M': 15.6881, 'S': 0.08454},
        25: {'L': -0.5684, 'M': 15.659, 'S': 0.08452},
        26: {'L': -0.5684, 'M': 15.6308, 'S': 0.08449},
        27: {'L': -0.5684, 'M': 15.6037, 'S': 0.08446},
        28: {'L': -0.5684, 'M': 15.5777, 'S': 0.08444},
        29: {'L': -0.5684, 'M': 15.5523, 'S': 0.08443},
        30: {'L': -0.5684, 'M': 15.5276, 'S': 0.08444},
        31: {'L': -0.5684, 'M': 15.5034, 'S': 0.08448},
        32: {'L': -0.5684, 'M': 15.4798, 'S': 0.08455},
        33: {'L': -0.5684, 'M': 15.4572, 'S': 0.08467},
        34: {'L': -0.5684, 'M': 15.4356, 'S': 0.08484},
        35: {'L': -0.5684, 'M': 15.4155, 'S': 0.08506},
        36: {'L': -0.5684, 'M': 15.3968, 'S': 0.08535},
        37: {'L': -0.5684, 'M': 15.3796, 'S': 0.08569},
        38: {'L': -0.5684, 'M': 15.3638, 'S': 0.08609},
        39: {'L': -0.5684, 'M': 15.3493, 'S': 0.08654},
        40: {'L': -0.5684, 'M': 15.3358, 'S': 0.08704},
        41: {'L': -0.5684, 'M': 15.3233, 'S': 0.08757},
        42: {'L': -0.5684, 'M': 15.3116, 'S': 0.08813},
        43: {'L': -0.5684, 'M': 15.3007, 'S': 0.08872},
        44: {'L': -0.5684, 'M': 15.2905, 'S': 0.08931},
        45: {'L': -0.5684, 'M': 15.2814, 'S': 0.08991},
        46: {'L': -0.5684, 'M': 15.2732, 'S': 0.09051},
        47: {'L': -0.5684, 'M': 15.2661, 'S': 0.0911},
        48: {'L': -0.5684, 'M': 15.2602, 'S': 0.09168},
        49: {'L': -0.5684, 'M': 15.2556, 'S': 0.09227},
        50: {'L': -0.5684, 'M': 15.2523, 'S': 0.09286},
        51: {'L': -0.5684, 'M': 15.2503, 'S': 0.09345},
        52: {'L': -0.5684, 'M': 15.2496, 'S': 0.09403},
        53: {'L': -0.5684, 'M': 15.2502, 'S': 0.0946},
        54: {'L': -0.5684, 'M': 15.2519, 'S': 0.09515},
        55: {'L': -0.5684, 'M': 15.2544, 'S': 0.09568},
        56: {'L': -0.5684, 'M': 15.2575, 'S': 0.09618},
        57: {'L': -0.5684, 'M': 15.2612, 'S': 0.09665},
        58: {'L': -0.5684, 'M': 15.2653, 'S': 0.09709},
        59: {'L': -0.5684, 'M': 15.2698, 'S': 0.0975},
        60: {'L': -0.5684, 'M': 15.2747, 'S': 0.09789},
        61: {'L': -0.8886, 'M': 15.2441, 'S': 0.09692},
        62: {'L': -0.9068, 'M': 15.2434, 'S': 0.09738},
        63: {'L': -0.9248, 'M': 15.2433, 'S': 0.09783},
        64: {'L': -0.9427, 'M': 15.2438, 'S': 0.09829},
        65: {'L': -0.9605, 'M': 15.2448, 'S': 0.09875},
        66: {'L': -0.978, 'M': 15.2464, 'S': 0.0992},
        67: {'L': -0.9954, 'M': 15.2487, 'S': 0.09966},
        68: {'L': -1.0126, 'M': 15.2516, 'S': 0.10012},
        69: {'L': -1.0296, 'M': 15.2551, 'S': 0.10058},
        70: {'L': -1.0464, 'M': 15.2592, 'S': 0.10104},
        71: {'L': -1.063, 'M': 15.2641, 'S': 0.10149},
        72: {'L': -1.0794, 'M': 15.2697, 'S': 0.10195},
        73: {'L': -1.0956, 'M': 15.276, 'S': 0.10241},
        74: {'L': -1.1115, 'M': 15.2831, 'S': 0.10287},
        75: {'L': -1.1272, 'M': 15.2911, 'S': 0.10333},
        76: {'L': -1.1427, 'M': 15.2998, 'S': 0.10379},
        77: {'L': -1.1579, 'M': 15.3095, 'S': 0.10425},
        78: {'L': -1.1728, 'M': 15.32, 'S': 0.10471},
        79: {'L': -1.1875, 'M': 15.3314, 'S': 0.10517},
        80: {'L': -1.2019, 'M': 15.3439, 'S': 0.10562},
        81: {'L': -1.216, 'M': 15.3572, 'S': 0.10608},
        82: {'L': -1.2298, 'M': 15.3717, 'S': 0.10654},
        83: {'L': -1.2433, 'M': 15.3871, 'S': 0.107},
        84: {'L': -1.2565, 'M': 15.4036, 'S': 0.10746},
        85: {'L': -1.2693, 'M': 15.4211, 'S': 0.10792},
        86: {'L': -1.2819, 'M': 15.4397, 'S': 0.10837},
        87: {'L': -1.2941, 'M': 15.4593, 'S': 0.10883},
        88: {'L': -1.306, 'M': 15.4798, 'S': 0.10929},
        89: {'L': -1.3175, 'M': 15.5014, 'S': 0.10974},
        90: {'L': -1.3287, 'M': 15.524, 'S': 0.1102},
        91: {'L': -1.3395, 'M': 15.5476, 'S': 0.11065},
        92: {'L': -1.3499, 'M': 15.5723, 'S': 0.1111},
        93: {'L': -1.36, 'M': 15.5979, 'S': 0.11156},
        94: {'L': -1.3697, 'M': 15.6246, 'S': 0.11201},
        95: {'L': -1.379, 'M': 15.6523, 'S': 0.11246},
        96: {'L': -1.388, 'M': 15.681, 'S': 0.11291},
        97: {'L': -1.3966, 'M': 15.7107, 'S': 0.11335},
        98: {'L': -1.4047, 'M': 15.7415, 'S': 0.1138},
        99: {'L': -1.4125, 'M': 15.7732, 'S': 0.11424},
        100: {'L': -1.4199, 'M': 15.8058, 'S': 0.11469},
        101: {'L': -1.427, 'M': 15.8394, 'S': 0.11513},
        102: {'L': -1.4336, 'M': 15.8738, 'S': 0.11557},
        103: {'L': -1.4398, 'M': 15.909, 'S': 0.11601},
        104: {'L': -1.4456, 'M': 15.9451, 'S': 0.11644},
        105: {'L': -1.4511, 'M': 15.9818, 'S': 0.11688},
        106: {'L': -1.4561, 'M': 16.0194, 'S': 0.11731},
        107: {'L': -1.4607, 'M': 16.0575, 'S': 0.11774},
        108: {'L': -1.465, 'M': 16.0964, 'S': 0.11816},
        109: {'L': -1.4688, 'M': 16.1358, 'S': 0.11859},
        110: {'L': -1.4723, 'M': 16.1759, 'S': 0.11901},
        111: {'L': -1.4753, 'M': 16.2166, 'S': 0.11943},
        112: {'L': -1.478, 'M': 16.258, 'S': 0.11985},
        113: {'L': -1.4803, 'M': 16.2999, 'S': 0.12026},
        114: {'L': -1.4823, 'M': 16.3425, 'S': 0.12067},
        115: {'L': -1.4838, 'M': 16.3858, 'S': 0.12108},
        116: {'L': -1.485, 'M': 16.4298, 'S': 0.12148},
        117: {'L': -1.4859, 'M': 16.4746, 'S': 0.12188},
        118: {'L': -1.4864, 'M': 16.52, 'S': 0.12228},
        119: {'L': -1.4866, 'M': 16.5663, 'S': 0.12268},
        120: {'L': -1.4864, 'M': 16.6133, 'S': 0.12307},
        121: {'L': -1.4859, 'M': 16.6612, 'S': 0.12346},
        122: {'L': -1.4851, 'M': 16.71, 'S': 0.12384},
        123: {'L': -1.4839, 'M': 16.7595, 'S': 0.12422},
        124: {'L': -1.4825, 'M': 16.81, 'S': 0.1246},
        125: {'L': -1.4807, 'M': 16.8614, 'S': 0.12497},
        126: {'L': -1.4787, 'M': 16.9136, 'S': 0.12534},
        127: {'L': -1.4763, 'M': 16.9667, 'S': 0.12571},
        128: {'L': -1.4737, 'M': 17.0208, 'S': 0.12607},
        129: {'L': -1.4708, 'M': 17.0757, 'S': 0.12643},
        130: {'L': -1.4677, 'M': 17.1316, 'S': 0.12678},
        131: {'L': -1.4642, 'M': 17.1883, 'S': 0.12713},
        132: {'L': -1.4606, 'M': 17.2459, 'S': 0.12748},
        133: {'L': -1.4567, 'M': 17.3044, 'S': 0.12782},
        134: {'L': -1.4526, 'M': 17.3637, 'S': 0.12816},
        135: {'L': -1.4482, 'M': 17.4238, 'S': 0.12849},
        136: {'L': -1.4436, 'M': 17.4847, 'S': 0.12882},
        137: {'L': -1.4389, 'M': 17.5464, 'S': 0.12914},
        138: {'L': -1.4339, 'M': 17.6088, 'S': 0.12946},
        139: {'L': -1.4288, 'M': 17.6719, 'S': 0.12978},
        140: {'L': -1.4235, 'M': 17.7357, 'S': 0.13009},
        141: {'L': -1.418, 'M': 17.8001, 'S': 0.1304},
        142: {'L': -1.4123, 'M': 17.8651, 'S': 0.1307},
        143: {'L': -1.4065, 'M': 17.9306, 'S': 0.13099},
        144: {'L': -1.4006, 'M': 17.9966, 'S': 0.13129},
        145: {'L': -1.3945, 'M': 18.063, 'S': 0.13158},
        146: {'L': -1.3883, 'M': 18.1297, 'S': 0.13186},
        147: {'L': -1.3819, 'M': 18.1967, 'S': 0.13214},
        148: {'L': -1.3755, 'M': 18.2639, 'S': 0.13241},
        149: {'L': -1.3689, 'M': 18.3312, 'S': 0.13268},
        150: {'L': -1.3621, 'M': 18.3986, 'S': 0.13295},
        151: {'L': -1.3553, 'M': 18.466, 'S': 0.13321},
        152: {'L': -1.3483, 'M': 18.5333, 'S': 0.13347},
        153: {'L': -1.3413, 'M': 18.6006, 'S': 0.13372},
        154: {'L': -1.3341, 'M': 18.6677, 'S': 0.13397},
        155: {'L': -1.3269, 'M': 18.7346, 'S': 0.13421},
        156: {'L': -1.3195, 'M': 18.8012, 'S': 0.13445},
        157: {'L': -1.3121, 'M': 18.8675, 'S': 0.13469},
        158: {'L': -1.3046, 'M': 18.9335, 'S': 0.13492},
        159: {'L': -1.297, 'M': 18.9991, 'S': 0.13514},
        160: {'L': -1.2894, 'M': 19.0642, 'S': 0.13537},
        161: {'L': -1.2816, 'M': 19.1289, 'S': 0.13559},
        162: {'L': -1.2739, 'M': 19.1931, 'S': 0.1358},
        163: {'L': -1.2661, 'M': 19.2567, 'S': 0.13601},
        164: {'L': -1.2583, 'M': 19.3197, 'S': 0.13622},
        165: {'L': -1.2504, 'M': 19.382, 'S': 0.13642},
        166: {'L': -1.2425, 'M': 19.4437, 'S': 0.13662},
        167: {'L': -1.2345, 'M': 19.5045, 'S': 0.13681},
        168: {'L': -1.2266, 'M': 19.5647, 'S': 0.137},
        169: {'L': -1.2186, 'M': 19.624, 'S': 0.13719},
        170: {'L': -1.2107, 'M': 19.6824, 'S': 0.13738},
        171: {'L': -1.2027, 'M': 19.74, 'S': 0.13756},
        172: {'L': -1.1947, 'M': 19.7966, 'S': 0.13774},
        173: {'L': -1.1867, 'M': 19.8523, 'S': 0.13791},
        174: {'L': -1.1788, 'M': 19.907, 'S': 0.13808},
        175: {'L': -1.1708, 'M': 19.9607, 'S': 0.13825},
        176: {'L': -1.1629, 'M': 20.0133, 'S': 0.13841},
        177: {'L': -1.1549, 'M': 20.0648, 'S': 0.13858},
        178: {'L': -1.147, 'M': 20.1152, 'S': 0.13873},
        179: {'L': -1.139, 'M': 20.1644, 'S': 0.13889},
        180: {'L': -1.1311, 'M': 20.2125, 'S': 0.13904},
        181: {'L': -1.1232, 'M': 20.2595, 'S': 0.1392},
        182: {'L': -1.1153, 'M': 20.3053, 'S': 0.13934},
        183: {'L': -1.1074, 'M': 20.3499, 'S': 0.13949},
        184: {'L': -1.0996, 'M': 20.3934, 'S': 0.13963},
        185: {'L': -1.0917, 'M': 20.4357, 'S': 0.13977},
        186: {'L': -1.0838, 'M': 20.4769, 'S': 0.13991},
        187: {'L': -1.076, 'M': 20.517, 'S': 0.14005},
        188: {'L': -1.0681, 'M': 20.556, 'S': 0.14018},
        189: {'L': -1.0603, 'M': 20.5938, 'S': 0.14031},
        190: {'L': -1.0525, 'M': 20.6306, 'S': 0.14044},
        191: {'L': -1.0447, 'M': 20.6663, 'S': 0.14057},
        192: {'L': -1.0368, 'M': 20.7008, 'S': 0.1407},
        193: {'L': -1.029, 'M': 20.7344, 'S': 0.14082},
        194: {'L': -1.0212, 'M': 20.7668, 'S': 0.14094},
        195: {'L': -1.0134, 'M': 20.7982, 'S': 0.14106},
        196: {'L': -1.0055, 'M': 20.8286, 'S': 0.14118},
        197: {'L': -0.9977, 'M': 20.858, 'S': 0.1413},
        198: {'L': -0.9898, 'M': 20.8863, 'S': 0.14142},
        199: {'L': -0.9819, 'M': 20.9137, 'S': 0.14153},
        200: {'L': -0.974, 'M': 20.9401, 'S': 0.14164},
        201: {'L': -0.9661, 'M': 20.9656, 'S': 0.14176},
        202: {'L': -0.9582, 'M': 20.9901, 'S': 0.14187},
        203: {'L': -0.9503, 'M': 21.0138, 'S': 0.14198},
        204: {'L': -0.9423, 'M': 21.0367, 'S': 0.14208},
        205: {'L': -0.9344, 'M': 21.0587, 'S': 0.14219},
        206: {'L': -0.9264, 'M': 21.0801, 'S': 0.1423},
        207: {'L': -0.9184, 'M': 21.1007, 'S': 0.1424},
        208: {'L': -0.9104, 'M': 21.1206, 'S': 0.1425},
        209: {'L': -0.9024, 'M': 21.1399, 'S': 0.14261},
        210: {'L': -0.8944, 'M': 21.1586, 'S': 0.14271},
        211: {'L': -0.8863, 'M': 21.1768, 'S': 0.14281},
        212: {'L': -0.8783, 'M': 21.1944, 'S': 0.14291},
        213: {'L': -0.8703, 'M': 21.2116, 'S': 0.14301},
        214: {'L': -0.8623, 'M': 21.2282, 'S': 0.14311},
        215: {'L': -0.8542, 'M': 21.2444, 'S': 0.1432},
        216: {'L': -0.8462, 'M': 21.2603, 'S': 0.1433},
        217: {'L': -0.8382, 'M': 21.2757, 'S': 0.1434},
        218: {'L': -0.8301, 'M': 21.2908, 'S': 0.14349},
        219: {'L': -0.8221, 'M': 21.3055, 'S': 0.14359},
        220: {'L': -0.814, 'M': 21.32, 'S': 0.14368},
        221: {'L': -0.806, 'M': 21.3341, 'S': 0.14377},
        222: {'L': -0.798, 'M': 21.348, 'S': 0.14386},
        223: {'L': -0.7899, 'M': 21.3617, 'S': 0.14396},
        224: {'L': -0.7819, 'M': 21.3752, 'S': 0.14405},
        225: {'L': -0.7738, 'M': 21.3884, 'S': 0.14414},
        226: {'L': -0.7658, 'M': 21.4014, 'S': 0.14423},
        227: {'L': -0.7577, 'M': 21.4143, 'S': 0.14432},
        228: {'L': -0.7496, 'M': 21.4269, 'S': 0.14441},
    },
}

def get_lms(gender, age_in_months):
    """
    Returns interpolated L, M, S values for a given gender and age (in months).
    Supports 0 to 228 months (19 years).
    """
    gender_key = gender.lower()
    if gender_key not in WHO_BMI_LMS:
        gender_key = 'girls' # Default
        
    gender_data = WHO_BMI_LMS[gender_key]
    
    # Clamp to bounds
    if age_in_months <= 0: 
        first_key = sorted(gender_data.keys())[0]
        return gender_data[first_key]
    
    last_key = sorted(gender_data.keys())[-1]
    if age_in_months >= last_key: 
        return gender_data[last_key]
    
    lower_idx = int(age_in_months)
    upper_idx = lower_idx + 1
    fraction = age_in_months - lower_idx
    
    # Retrieve values
    lower = gender_data.get(lower_idx)
    upper = gender_data.get(upper_idx)
    
    if not lower:
        # Fallback to nearest available lower
        available_keys = sorted(gender_data.keys())
        lower_keys = [k for k in available_keys if k <= lower_idx]
        if not lower_keys: return gender_data[available_keys[0]]
        lower = gender_data[lower_keys[-1]]
        
    if not upper:
        # Fallback to nearest available upper
        available_keys = sorted(gender_data.keys())
        upper_keys = [k for k in available_keys if k >= upper_idx]
        if not upper_keys: return gender_data[available_keys[-1]]
        upper = gender_data[upper_keys[0]]
        
    # Linear Interpolation
    l_curr = lower['L'] + fraction * (upper['L'] - lower['L'])
    m_curr = lower['M'] + fraction * (upper['M'] - lower['M'])
    s_curr = lower['S'] + fraction * (upper['S'] - lower['S'])
    
    return {'L': l_curr, 'M': m_curr, 'S': s_curr}

def calculate_bmi_z_score(bmi, gender, age_in_months):
    """
    Calculates the BMI-for-age Z-score using the LMS method.
    Formula: Z = ((BMI / M)^L - 1) / (L * S)  if L != 0
             Z = ln(BMI / M) / S              if L == 0
    """
    if bmi is None or age_in_months is None:
        return None
        
    lms = get_lms(gender, age_in_months)
    L = lms['L']
    M = lms['M']
    S = lms['S']
    
    if L == 0:
        import math
        z = math.log(bmi / M) / S
    else:
        z = ((bmi / M)**L - 1) / (L * S)
        
    return z

def classify_who_z_score(z_score, age_in_months):
    """
    Classifies Z-score based on WHO cutoffs.
    
    0-5 Years (Months 0-60):
    > 3 SD: Obese
    > 2 SD: Overweight
    > 1 SD: Risk of overweight
    -2 to +1 SD: Normal
    < -2 SD: Wasted
    < -3 SD: Severely Wasted
    
    5-19 Years (Months 61-228):
    > 2 SD: Obese
    > 1 SD: Overweight
    -2 to +1 SD: Normal
    < -2 SD: Thinness
    < -3 SD: Severe Thinness
    """
    if z_score is None:
        return "Missing"
    
    if age_in_months <= 60: # 0-5 Years
        if z_score > 3:
            return "Obese"
        elif z_score > 2:
            return "Overweight"
        elif z_score > 1:
            return "Risk of Overweight"
        elif z_score < -3:
            return "Severe Underweight"
        elif z_score < -2:
            return "Underweight"
        else:
            return "Normal"
    else: # 5-19 Years
        if z_score > 2:
            return "Obese"
        elif z_score > 1:
            return "Overweight"
        elif z_score < -3:
            return "Severe Underweight"
        elif z_score < -2:
            return "Underweight"
        else:
            return "Normal"
